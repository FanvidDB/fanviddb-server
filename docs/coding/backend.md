---
layout: default
title: Backend
---

# Backend

<div class="alert alert-info" role="alert">
  The instructions on this page assume that you are familiar with GitHub and the command line.
  If you are not but want to be, check out [First Day On Github](https://lab.github.com/githubtraining/first-day-on-github)!
</div>

## Setup (Mac OS)

### Fork & clone the repository

First, visit [github.com/FanvidDB/fanviddb-server](https://github.com/FanvidDB/fanviddb-server) and click on "Fork" to create a fork of the repository.

```bash
git clone git@github.com:your-username/fanviddb-server.git
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

### Create `.env` file

From the root of the repository, run the following:

```
cat << EOF  > .env
DATABASE_URL="postgresql://postgres:postgres@localhost/fanviddb"
AUTH_SECRET_KEY="secret"
EMAIL_TOKEN_SECRET_KEY="secret"
EOF
```

This will create a `.env` file with the basic configuration needed by the app.

### Database configuration
1. Install [Postgres.app](https://postgresapp.com/)
2. Open Postgres.app and double-click on the `postgres` database
3. Run `CREATE DATABASE fanviddb;` in the terminal that opens to create a database called `fanviddb`.
4. Run `alembic upgrade head` to create the database tables that the application needs.

## Running the server

```
uvicorn fanviddb.api:app --reload
```

This will automatically reload the server when your code changes.

## Before you push new code

If you make changes to the backend code, make sure to run the following commands prior to creating a pull request:

```bash
pytest    # Runs python tests
make fmt  # Auto-enforces some code style
make lint # Checks code style
```

## Autogenerated migrations

For simple migrations, you can [automatically generate them with alembic](https://alembic.sqlalchemy.org/en/latest/autogenerate.html):

```
alembic revision --autogenerate -m "brief description"
```

Once generated, migrations can be applied with `alembic upgrade head`.
